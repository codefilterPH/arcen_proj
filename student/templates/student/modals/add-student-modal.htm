{% load static %}

<!-- Add Participant Modal -->
<div class="modal fade" id="addParticipantModal" tabindex="-1" aria-labelledby="addParticipantModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content rounded-lg shadow-lg">

      <!-- Header -->
      <div class="modal-header bg-blue-600 text-white rounded-t-lg px-4 py-2 flex items-center justify-between">
        <h5 class="modal-title text-lg font-semibold flex items-center gap-2" id="addParticipantModalLabel">
          <i class="fas fa-user-plus text-white text-m"></i>
          Add Participants
        </h5>
        <button type="button"
                class="text-white hover:text-gray-200 transition"
                data-bs-dismiss="modal"
                aria-label="Close">
          <i class="fas fa-times text-lg"></i>
        </button>
      </div>

      <!-- Body -->
      <div class="modal-body p-4">

        <!-- ðŸ”¹ Dropdown + Add Button -->
        <div class="mb-4">
          <label for="participantSelect" class="block text-sm font-medium text-gray-700 mb-1">
            Select User
          </label>
          <div class="flex items-center gap-2">
            <!-- Dropdown -->
            <div class="relative flex-grow">
              <select id="participantSelect"
                      class="w-full rounded-md border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:outline-none px-3 py-2 text-sm"
                      required>
                <!-- Options loaded dynamically -->
              </select>
              <!-- Spinner -->
              <div id="spinnerParticipant"
                   class="hidden absolute right-3 top-1/2 -translate-y-1/2">
                <div class="spinner-border text-blue-500"></div>
              </div>
            </div>

            <!-- Add Button -->
            <button type="button"
                    id="btnAddToTable"
                    class="inline-flex items-center justify-center bg-green-600 hover:bg-green-700 text-white rounded-md p-2 transition">
              <i class="fas fa-user-plus text-white text-lg"></i>
            </button>
          </div>

          <!-- Messages -->
          <p id="participantMessage" class="text-sm text-red-500 mt-2"></p>
          <p id="participantInfo" class="text-sm text-gray-500 mt-1"></p>
        </div>

        <!-- ðŸ”¹ Selected Participants Table -->
        <div class="mt-6">
          <h6 class="font-semibold text-gray-700 flex items-center gap-2">
            <i class="fas fa-users text-blue-600"></i>
            Selected Participants
          </h6>
          <div class="overflow-x-auto mt-3">
            <table class="min-w-full border border-gray-200 text-sm text-gray-700" id="participantsTable">
              <thead class="bg-gray-100">
                <tr>
                  <th class="w-12 text-center py-2 border-b">#</th>
                  <th class="text-left py-2 border-b">Name</th>
                  <th class="w-16 text-center py-2 border-b">Action</th>
                </tr>
              </thead>
              <tbody>
                <!-- Rows will be dynamically appended -->
              </tbody>
            </table>
          </div>
        </div>

      </div>

      <!-- Footer -->
      <div class="modal-footer flex justify-end gap-0 bg-gray-50 rounded-b-lg p-3">
        <button type="button"
                class="inline-flex items-center justify-center bg-gray-500 hover:bg-gray-600 text-white rounded-md p-2 transition"
                data-bs-dismiss="modal">
          <i class="fas fa-times text-white text-lg"></i>
        </button>
        <button type="button"
                id="btnSaveAllParticipants"
                class="inline-flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white rounded-md p-2 transition">
          <i class="fas fa-save text-white text-lg"></i>
        </button>
      </div>

    </div>
  </div>
</div>

{% block extra_js %}
<script src="{% static 'js/student/load-students.js' %}"></script>
<script src="{% static 'js/student/actions.js' %}"></script>
<script>
  $(document).ready(function() {
    $('#addParticipantModal').on('shown.bs.modal', function () {
      loadUsers();  // Load users when modal opens
    });
  });
</script>
{% endblock %}

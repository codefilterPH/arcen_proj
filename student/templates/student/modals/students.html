{% load static %}
{% block extra_css %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
<style>
  .student-photo {
    width: 50px;
    height: 50px;
    object-fit: cover;
    border-radius: 50%;
  }
  .qr-code {
    width: 50px;
    height: 50px;
  }
  .table th {
    vertical-align: middle;
  }
  .action-btns .btn {
    padding: 4px 8px;
  }
</style>

{% endblock %}

<!-- Students Modal -->
<div class="modal fade" id="studentsModal" tabindex="-1" aria-labelledby="studentsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">

      <!-- Header -->
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="studentsModalLabel"><i class="fas fa-user-graduate me-2"></i> Students Management</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <!-- Body -->
      <div class="modal-body bg-light">

        <!-- ðŸ”¹ Filter Controls -->
        <div class="row align-items-end mb-3">
          <div class="col-md-3">
            <label class="form-label fw-semibold">School Year</label>
            <select class="form-select" id="filterSchoolYear">
              <option selected disabled>Select School Year</option>
              <option>2022â€“2023</option>
              <option>2023â€“2024</option>
              <option>2024â€“2025</option>
            </select>
          </div>

          <div class="col-md-3">
            <label class="form-label fw-semibold">Semester</label>
            <select class="form-select" id="filterSemester">
              <option selected disabled>Select Semester</option>
              <option>First Semester</option>
              <option>Second Semester</option>
              <option>Summer Term</option>
            </select>
          </div>

          <div class="col-md-3">
            <label class="form-label fw-semibold">Flight</label>
            <select class="form-select" id="filterFlight">
              <option selected disabled>Select Flight</option>
              <option>Alpha</option>
              <option>Bravo</option>
              <option>Charlie</option>
              <option>Delta</option>
            </select>
          </div>

          <div class="col-md-3 text-end">
            <!-- Add Student Button -->
            <button type="button"
                    class="btn btn-success mt-3"
                    id="btnAddStudent"
                    data-bs-toggle="modal"
                    data-bs-target="#addParticipantModal">
                <i class="fas fa-user-plus me-1"></i> Add Student
            </button>
          </div>
        </div>

        <!-- ðŸ”¹ Students Table -->
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle bg-white shadow-sm rounded" id="studentsTable">
            <thead class="table-primary">
              <tr>
                <th scope="col">Image</th>
                <th scope="col">QR Code</th>
                <th scope="col">Name</th>
                <th scope="col">School Year</th>
                <th scope="col">Semester</th>
                <th scope="col">Flight</th>
                <th scope="col">Status</th>
                <th scope="col" class="text-center">Actions</th>
              </tr>
            </thead>
            <tbody>
              <!-- Dummy Rows -->
              <tr>
                <td><img src="{% static 'img/no_image.png' %}" alt="Student" class="student-photo"></td>
                <td><img src="{% static 'img/qr_sample.png' %}" alt="QR Code" class="qr-code"></td>
                <td>John Doe</td>
                <td>2024â€“2025</td>
                <td>First Semester</td>
                <td>Alpha</td>
                <td><span class="badge bg-success">Active</span></td>
                <td class="text-center action-btns">
                  <button class="btn btn-sm btn-info text-white" title="Reports"><i class="fas fa-chart-bar"></i></button>
                  <button class="btn btn-sm btn-warning text-white" title="Edit"><i class="fas fa-edit"></i></button>
                  <button class="btn btn-sm btn-danger" title="Delete"><i class="fas fa-trash"></i></button>
                </td>
              </tr>
              <tr>
                <td><img src="{% static 'img/no_image.png' %}" alt="Student" class="student-photo"></td>
                <td><img src="{% static 'img/qr_sample.png' %}" alt="QR Code" class="qr-code"></td>
                <td>Jane Smith</td>
                <td>2023â€“2024</td>
                <td>Second Semester</td>
                <td>Bravo</td>
                <td><span class="badge bg-secondary">Inactive</span></td>
                <td class="text-center action-btns">
                  <button class="btn btn-sm btn-info text-white" title="Reports"><i class="fas fa-chart-bar"></i></button>
                  <button class="btn btn-sm btn-warning text-white" title="Edit"><i class="fas fa-edit"></i></button>
                  <button class="btn btn-sm btn-danger" title="Delete"><i class="fas fa-trash"></i></button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

      </div>

      <!-- Footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          <i class="fas fa-times me-1"></i> Close
        </button>
      </div>

    </div>
  </div>
</div>

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Handle Filter Changes
  $("#filterSchoolYear, #filterSemester, #filterFlight").on("change", function() {
    const year = $("#filterSchoolYear").val();
    const sem = $("#filterSemester").val();
    const flight = $("#filterFlight").val();
    console.log(`ðŸ§­ Filter changed: ${year || "â€”"} | ${sem || "â€”"} | ${flight || "â€”"}`);
    // You can trigger loadStudents(year, sem, flight);
  });

  // Handle Add Student Button
  $("#btnAddStudent").on("click", function() {
    console.log("âž• Add student clicked");
    // openAddStudentModal();  // your function to open add student form
  });
</script>
{% endblock %}
